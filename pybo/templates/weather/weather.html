{% extends 'base.html' %}
{% block head %}
<!-- ë¡œë”©ì°½ -->
<link rel="stylesheet" href="{{ url_for('static', filename='loading.css') }}">
<script src="{{ url_for('static', filename='loading.js') }}"></script>
{% endblock %}
{% block content %}
<div class="container">
    <div class="table-responsive">
        <h1> {{ site[0] }} {{ site[1]}} {{ site[2] }} </h1>
        <table class="table">
            <colgroup>
                <col span="23">
                <col span='1' style="border-right:4px solid #000000;">
                <col span="23">
                <col span='1' style="border-right:4px solid #000000;">
            </colgroup>
            <thead>
            {% if info %}
                <tr class="bg-info">
                    <th colspan="24" class="bg-danger">
                        {{ info.fcst['SKY'][0][0][:4] }} ë…„ {{ info.fcst['SKY'][0][0][4:6] }}ì›” {{ info.fcst['SKY'][0][0][6:] }}ì¼
                    </th>
                    <th colspan="24", class="bg-primary">
                        {{ info.fcst['SKY'][24][0][:4] }} ë…„ {{ info.fcst['SKY'][24][0][4:6] }}ì›” {{ info.fcst['SKY'][24][0][6:] }}ì¼
                    </th>
                    <th colspan="24">
                        {{ info.fcst['SKY'][48][0][:4] }} ë…„ {{ info.fcst['SKY'][48][0][4:6] }}ì›” {{ info.fcst['SKY'][48][0][6:] }}ì¼
                    </th>
                </tr>
                <tr class="text-center bg-info">
                    {% for i, dt in info.fcst['SKY']|enu %}
                    {% if i < 24 %}
                    <th class="bg-danger">
                    {% elif i < 48 %}
                    <th class="bg-primary">
                    {% else %}
                    <th>
                    {% endif %}
                        {{ dt[1][:2] }}ì‹œ
                    </th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                <tr class="text-center table-info">
                    {% for i, sky in info.fcst['SKY']|enu %}
                    {% if i < 24 %}
                    <td class="table-danger">
                    {% elif i < 48 %}
                    <td class="table-primary">
                    {% else %}
                    <td>
                    {% endif %}
                        {% if sky[2] == '1' %}
                        {% if sky[1][:2]|int >= 6 and sky[1][:2]|int < 18 %}
                        <img src="{{ url_for('static', filename='sky/Clear.png') }}"><br>
                        {% else %}
                        <img src="{{ url_for('static', filename='sky/ClearNight.png') }}"><br>
                        {% endif %}
                        ë§‘ì•„ë¶€ëŸ¬
                        {% elif sky[2] == '3' %}
                        {% if sky[1][:2]|int >= 6 and sky[1][:2]|int < 18 %}
                        <img src="{{ url_for('static', filename='sky/MostlyCloudy.png') }}"><br>
                        {% else %}
                        <img src="{{ url_for('static', filename='sky/MostlyCloudyNight.png') }}"><br>
                        {% endif %}
                        êµ¬ë¦„ ì†”ì°¬íˆ ë§ì–´
                        {% else %}
                        <img src="{{ url_for('static', filename='sky/Cloudy.png') }}"><br>
                        íë¦¬ë‹¹ê»˜
                        {% endif %}
                    </td>
                    {% endfor %}
                </tr>
                <tr class="text-center table-info">
                    {% for i, tmp in info.fcst['TMP']|enu %}
                    {% if i < 24 %}
                    <td class="table-danger">
                    {% elif i < 48 %}
                    <td class="table-primary">
                    {% else %}
                    <td>
                    {% endif %}
                        ğŸŒ¡ï¸ {{ tmp[2] }} Â°C
                    </td>
                    {% endfor %}
                </tr>
                <tr class="text-center table-info">
                    {% for i, rain in info.fcst['POP']|enu %}
                    {% if i < 24 %}
                    <td class="table-danger">
                    {% elif i < 48 %}
                    <td class="table-primary">
                    {% else %}
                    <td>
                    {% endif %}
                        <img src="{{ url_for('static', filename='sky/rainy.png') }}"> {{ rain[2] }} %
                    </td>
                    {% endfor %}
                </tr>
            {% else %}
            <tr>
                <td colspan="3">ë‚ ì”¨ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</td>
            </tr>
            {% endif %}
            </tbody>
        </table>
    </div>

    <h3>ë‹¤ë¥¸ ê³³ì˜ ë‚ ì”¨ê°€ ê¶ê¸ˆí•œê°€ìš”?</h3>
    <form method="get">
        <label for="si">ëŒ€ë¶„ë¥˜ :</label><br>
        <select class="form-select" id="si" name="si">
            <option value="" selected disabled hidden >ì„ íƒí•´ì£¼ì„¸ìš”.</option>
        </select><br>
        
        <label for="gun">ì¤‘ë¶„ë¥˜ :</label><br>
        <select class="form-select" id="gun" name="gun" disabled>
        </select><br>

        <label for="dong">ì†Œë¶„ë¥˜ :</label><br>
        <select class="form-select" id="dong" name="dong" disabled>
        </select><br>

        <button onclick="showLoading()" class="btn btn-primary" type="submit" id="submit" disabled> ì¡°íšŒ </button>
    </form><br>
</div>

{% endblock %}
{% block script %}
<script type='text/javascript' id=city src="{{ url_for('static', filename='city_table.json')}}"></script>
<script>
var select_si = document.getElementById("si")
var select_gun = document.getElementById("gun")
var select_dong = document.getElementById("dong")
var button = document.getElementById('submit')

for ( var first in data ) {
    var opt = document.createElement('option');
    opt.setAttribute('value', first);
    opt.innerHTML = first;
    select_si.appendChild(opt);
}

select_si.addEventListener("change", function(element) {
    button.setAttribute('disabled', "")
    select_gun.removeAttribute('disabled')
    select_gun.replaceChildren()
    var opt_default = document.createElement('option');
    opt_default.setAttribute('value', "");
    opt_default.setAttribute('disabled', "");
    opt_default.setAttribute('selected', "");
    opt_default.setAttribute('hidden', "");
    opt_default.innerHTML = "ì„ íƒí•´ì£¼ì„¸ìš”."
    select_gun.appendChild(opt_default)
    select_dong.replaceChildren()
    select_dong.setAttribute('disabled', "")
    for ( var second in data[select_si.value] ) {
        var opt = document.createElement('option');
        opt.setAttribute('value', second);
        opt.innerHTML = second;
        select_gun.appendChild(opt);
    }
})
select_gun.addEventListener("change", function(element) {
    button.setAttribute('disabled', "")
    select_dong.removeAttribute('disabled')
    select_dong.replaceChildren()
    var opt_default = document.createElement('option');
    opt_default.setAttribute('value', "");
    opt_default.setAttribute('disabled', "");
    opt_default.setAttribute('selected', "");
    opt_default.setAttribute('hidden', "");
    opt_default.innerHTML = "ì„ íƒí•´ì£¼ì„¸ìš”."
    select_dong.appendChild(opt_default)
    for ( var third in data[select_si.value][select_gun.value] ) {
        var opt = document.createElement('option');
        opt.setAttribute('value', data[select_si.value][select_gun.value][third]);
        opt.innerHTML = data[select_si.value][select_gun.value][third];
        select_dong.appendChild(opt);
    }
})
select_dong.addEventListener("change", function(element) {
    button.removeAttribute('disabled')
})
</script>
{% endblock %}